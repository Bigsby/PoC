{
    "$schema": "http://json-schema.org/draft-06/schema#",
    "$id": "musicJson",
    "title": "Music Score  Notation",
    "description": "A JSON notation for musical scores.",
    "type": "object",
    
    "definitions": {
        "moreThanOneInteger": {
            "type": "integer",
            "minimum": 1
        },
        "key": {
            "type": "string",
            "enum": [
                "A", "A#", "Ab",
                "B", "B#", "Bb",
                "C", "C#", "Cb",
                "D", "D#", "Db",
                "E", "E#", "Eb",
                "F", "F#", "Fb",
                "G", "G#", "Gb"
            ]
        },
        "namedObject": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string"
                }
            }
        },
        "metadata": {
            "properties": {
                "title": { "type": "string",
                "description": "The name of the composition" },
                "authors": { "type": "string", "description": "The name of who created this file." },
                "composers": { "type": "string", "description": "" },
                "composingDate": { "type": "string", "format": "date-time" },
                "creationDate": { "type": "string", "format": "date-time" }
            }
        },
        "signatures": {
            "type": "object",
            "properties": {
                "timeSignature": {
                    "$ref": "#/definitions/timeSignature",
                    "default": "4/4"
                },
                "tempo": {
                    "$ref": "#/definitions/tempo"
                },
                "key": {
                    "$ref": "#/definitions/key"
                }
            }
        },
        "noteDuration": {
            "type": "string",
            "enum": [
                "double-whole", "breve", "dw",
                "whole", "semibreve", "w",
                "half", "minim", "h",
                "quarter", "crotchet", "1/4",
                "eighth", "quaver", "1/8",
                "sixteenth", "semiquaver", "1/16",
                "thirty-second", "demisemiquaver", "1/32",
                "sixty-fourth", "hemidemisemiquaver", "1/64",
                "hundred-twenty-eighth", "semihemidemisemiquaver", "1/128",
                "two-hundred fifty-sixth", "demisemihemidemisemiquaver", "1/256"
            ]
        },
        "duration": {
            "oneOf": [
                { "$ref": "#/defintions/noteDuration" },
                {
                    "type": "object",
                    "properties": {
                        "note": {
                            "$ref": "#/defintions/noteDuration"
                        },
                        "dotted": {
                            "type": "boolean",
                            "default": false
                        }
                    }
                }
            ]
        },
        "tempo": {
            "oneOf": [{
                    "type": "string"
                },
                {
                    "type": "object",
                    "properties": {
                        "unit": {
                            "$ref": "#/definitions/noteDuration"
                        },
                        "value": {
                            "$ref": "#/definitions/moreThanOneInteger"
                        }
                    }
                }
            ]
        },
        "timeSignature": {
            "oneOf": [{
                    "type": "string",
                    "pattern": "^([2-9]|(?:(?:1|2)[0-9])|(?:3[0-2]))\/(2|4|8|(?:16)|(?:32))$"
                },
                {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "integer",
                            "minimum": 2,
                            "maximum": 32
                        },
                        "beats": {
                            "type": "integer",
                            "enum": [2, 4, 8, 16, 32]
                        }
                    },
                    "required": [
                        "value",
                        "beats"
                    ]
                }
            ]
        },
        "barline-start":{
            "type": "string",
            "enum": [
                "normal",
                "repeat-start"
            ]
        },
        "barline-end":{
            "type": "string",
            "enum": [
                "normal",
                "repeat-end"
            ]
        },
        "bar": {
            "type": "object",
            "properties": {
                "timeSignature": {
                    "$ref": "#/definitions/timeSignature"
                },
                "clef:": {
                    "$ref": "#/definitions/clef"
                },
                "key": {
                    "$ref": "#/definitions/key"
                },
                "barline-start": {
                    "$ref": "#/definitions/barline-start"
                },
                "barline-end": {
                    "$ref": "#/definitions/barline-end"
                },
                "voices":{
                    "type":"array",
                    "items": {
                    "$ref": "#/definitions/voice"
                    }
                }
            }
        },
        "clefs": {
            "type": "string",
            "enum": ["G", "F", "C"]
        },
        "clef": {
            "oneOf": [{
                    "$ref": "#/definitions/clefs"
                },
                {
                    "type": "object",
                    "properties": {
                        "note": {
                            "$ref": "#/definitions/clefs"
                        },
                        "line": {
                            "type": "integer",
                            "minimum": 1,
                            "maximum": 5
                        }
                    }
                },
                {
                    "type": "string",
                    "enum": [
                        "G1", "french-violin",
                        "G2", "treble",
                        "C1", "soprano",
                        "C2", "mezzo-soprano",
                        "C3", "alto",
                        "C4", "tenor",
                        "C5", "baritone-c",
                        "F3", "baritone-f",
                        "F4", "bass",
                        "F5", "subbass"
                    ]
                }
            ]
        },
        "part": {
            "allOf": [
                { "$ref": "#/definitions/namedObject" },
                {
                    "properties": {
                        "clef": {
                            "$ref": "#/definitions/clef"
                        },
                        "key": {
                            "$ref": "#/definitions/key"
                        },
                        "bars": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/bar"
                            }
                        }
                    },
                    "required": [
                        "clef"
                    ]
                }
            ]
        },
        "note": {
            "type": "object"
        },
        "voice-type":{
            "type": "string",
            "enum":[
                "notes",
                "harmony",
                "rythm",
                "lyrics"
            ]
        },
        "voice": {
            "type": "object"
        },
        "system": {
            "oneOf": [
                {
                    "type":"object",
                    "properties": {
                        "systems":{
                            "type": "array",
                            "items":{
                                "$ref": "#/definitions/system"
                            }
                        }
                    }
                },
                {
                    "type":"object",
                    "properties": {
                        "parts":{
                            "type": "array",
                            "items":{
                                "$ref": "#/definitions/part"
                            }
                        }
                    }
                }
            ]
        }
    },
    "allOf": [
        { "$ref": "#/definitions/system" },
        {
            "properties": {
                "metadata": { "$ref": "#/definitions/metadata" },
                "signatures": { "$ref": "#/definitions/signatures" }
            }
        }
    ]
}